{"version":3,"sources":["webpack:///./src/bus.js","webpack:///./src/lib/fetch.js","webpack:///./src/lib/createRedditDataClient.js","webpack:///./src/lib/redditDataClient.js","webpack:///./src/lib/buildGraph.js","webpack:///./src/Progress.js","webpack:///./src/appState.js","webpack:///./src/lib/measureText.js","webpack:///./src/lib/layout/Vector.js","webpack:///./src/lib/layout/flock.js","webpack:///./src/lib/layout/boidLayout.js","webpack:///./src/lib/layout/getDelaunayGraph.js","webpack:///./src/lib/layout/makeSpanningTree.js","webpack:///./src/lib/layout/removeOverlaps.js","webpack:///./src/lib/layout/Rect.js","webpack:///./src/lib/aggregateLayout.js","webpack:///./src/lib/createInterpolateLayout.js","webpack:///./src/lib/renderer/linkAnimator.js","webpack:///./src/lib/createRenderer.js","webpack:///src/components/About.vue","webpack:///./src/components/About.vue?6699","webpack:///./src/components/About.vue","webpack:///src/components/Typeahead.vue","webpack:///./src/components/Typeahead.vue?695c","webpack:///./src/components/Typeahead.vue","webpack:///src/App.vue","webpack:///./src/App.vue?c6b6","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["bus","require","request","url","options","req","cancelable","promise_default","a","resolve","reject","XMLHttpRequest","progress","addEventListener","e","lengthComputable","loaded","total","percent","status","response","responseType","JSON","parse","cancelled","message","open","method","headers","keys_default","forEach","key","setRequestHeader","send","body","cancel","abort","fuzzysort","redditDataClient","endpoint","fileNamesIndex","fileNames","map_default","name","fileName","replace","i","length","letter","set","downloaded","indexed","list","prepared","sizeCount","sizes","fetch","then","rows","row","index","subreddit","getRelated","query","sims","get","toLocaleLowerCase","firstLetter","downloadAndIndexFile","getFileForQuery","getSuggestion","results","go","limit","map","x","html","highlight","text","target","getSize","subName","console","log","keyName","push","l","prepare","createRedditDataClient","buildGraph","entryWord","MAX_DEPTH","trim","pendingResponse","graph","maxDepth","queue","requestDelay","startDownload","fetchNext","dispose","loadNext","nextWord","shift","updateLayout","fire","res","parent","parentNode","getNode","addNode","depth","size","other","idx","hasNode","getLink","addLink","data","setTimeout","onPendingReady","catch","msg","err","error","downloadError","Progress","classCallCheck_default","this","phase","download","errors","remaining","currentWord","layout","iteration","working","layoutCompletion","qs","queryState","useSearch","lastBuilder","appStateFromQuery","appState","hasGraph","performSearch","queryString","reset","freeze_default","onChange","newState","svgns","xmlns","createTextMeasure","svgContainer","useFastTextMeasure","cachedSizes","cachedWords","create_default","abc","avgLetterWidthByFontSize","safariGuess","1","0.875","0.833","0.75","0.5","fontSize","Math","round","cacheKey","cachedResult","result","textContainer","window","document","createElementNS","setAttributeNS","appendChild","words","split","width","avgWidthAtFontSize","textContent","abcWidth","measureTextWidth","measureAvgWidth","cachedWordsKey","undefined","Error","preciseMeasure","measureText","spaceWidth","spaceWidthKey","totalWidth","word","sumUpWordsLengthInPixels","removeChild","svgTextElement","getBBox","Vector","y","createClass_default","value","sqrt","scalar","maxMag","mag","dx","dy","b","random","Flock","boids","neighbors","_this","boid","nodeId","forEachLinkedNode","otherBoid","id","run","boidId","pos","setDesiredPosition","Boid","acceleration","angle","nextDouble","PI","velocity","cos","sin","position","desiredPosition","r","maxspeed","maxforce","flock","borders","update","force","nCount","div","add","sep","separate","ali","align","coh","cohesion","mass","applyForce","pull","sub","mult","desired","normalize","steer","_this2","count","d","distanceTo","diff","_this3","sum","dist","_this4","seek","createRandom","addTriangulationLink","fromId","toId","tGraph","createGraph","randomAPI","EdgeModel","from","to","removeOverlaps","rectangles","vertices","canMove","yes","pullX","pullY","pair","cx","cy","totalMovement","triangulationGraph","triangles","Delaunator","v","first","second","third","getDelaunayGraph","forEachLink","link","getRect","weight","overlaps","centerDistance","getPointDistance","t","getOverlapFactor","right","left","top","bottom","getRectangularDistance","getTriangulationWeight","mstEdges","findMinimumSpanningTree","edge","randomIterator","shuffle","spanningTree","spanningGraph","getGraph","processed","set_default","growAt","has","rootPos","otherNode","childPos","removeOverlapsForRectangles","getRootId","grow","rootId","gentNode","makeSpanningTree","arrayOfRects","from_default","is_finite_default","abs","wx","wy","height","min","Rect","params","assign_default","isNumber","factor","eventify","createLayout","USE_FAKE","USE_INTERPOLATE","REMOVE_OVERLAPS","USE_REAL","createAggregateLayout","physicsLayout","springLength","springCoeff","gravity","theta","dragCoeff","timeStep","nodeMass","links","getLinks","mul","node","fakeLayout","nodes","getNodePosition","setDesiredNodePosition","setDesiredBoidPosition","step","addBoid","createFakeLayout","interpolateLayout","duration","arguments","elapsed","ease","fromPos","toPos","done","createInterpolateLayout","isGraphReady","layoutIterations","layoutTime","maxLayoutIterations","maxLayoutTime","api","start","performance","now","finished","max","forEachNode","setLayoutCompletion","getRectangles","move","delta","newMove","rect","setNodePosition","runOverlapsRemoval","pinNode","setGraphReady","getGraphReady","rects","inflatedRect","svg","createRenderer","scene","querySelector","nodeContainer","edgeContainer","lastPanTime","lastTouchEndTime","clickTimeout","panzoom","createPanZoom","defaultRectangle","showRectangle","currentLayoutFrame","linkAnimator","textMeasure","on","onGraphReady","render","newGraph","clearLastScene","drawLinks","onGraphStructureChanged","cancelAnimationFrame","requestAnimationFrame","frame","off","onMouseClick","clickTarget","contains","getNodeIdFromUI","removeClass","mainNode","classList","ui","moveToFront","linkInfo","getLinkInfo","linkUI","onDoubleClickMouse","stopPropagation","onDoubleClick","el","className","elements","querySelectorAll","remove","readyGraph","startLayout","attr","changes","change","changeType","beingAnimated","scheduled","maxAnimations","sort","getLinkScore","processor","processNext","pop","speed","gaussian","animateLink","isDone","delete","linkId","fromNode","toNode","maxT","dRatio","strokeWidth","color","pathData","stroke-width","fill","stroke","createLinkAnimator","onTouchEnd","onPan","clear","removeEventListener","Date","dTouchEnd","dPan","clearTimeout","lastChild","uiAttributes","rx","ry","px","py","getNodeUIAttributes","rectAttributes","textAttributes","font-size","class","transform","About","mounted","closeHandler","keyCode","preventDefault","close","beforeDestroy","methods","$emit","components_About","_vm","_h","$createElement","_c","_self","staticClass","click","$event","_v","attrs","href","staticStyle","src","alt","_m","staticRenderFns","Typeahead","props","readonly","default","placeholder","getSuggestions","delay","currentSelected","showSuggestions","showLoading","loadingError","suggestions","currentQuery","watch","newQuery","refresh","getSuggestionsInternal","hideSuggestions","pendingKeyToShow","showIfNeeded","visible","focus","$refs","input","pickCurrentText","pickSuggestion","suggestion","self","previous","p","Array","isArray","selected","cycleTheList","items","which","components_Typeahead","directives","rawName","expression","ref","autofocus","autocomplete","autocorrect","autocapitalize","spellcheck","domProps","composing","keydown","type","_e","_l","innerHTML","_s","App","aboutVisible","src_appState","tooltip","components","__webpack_require__","normalizeComponent","ssrContext","Typeahead_normalizeComponent","Subreddit","vuereddit_umd_default","computed","isLoading","doSearch","q","onSubmit","lib_redditDataClient","renderer","blur","showSubreddit","src_bus","selectortype_template_index_0_src_App","submit","ref:typeahead","get-suggestions","src_App","App_normalizeComponent","Vue","config","productionTip","template"],"mappings":"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","file":"static/js/app.f2b08a99c5fac68b36bf.js","sourcesContent":["const bus = require('ngraph.events')({});\n\nexport default bus;\n\n\n\n// WEBPACK FOOTER //\n// ./src/bus.js","export default function request(url, options) {\n  if (!options) options = {};\n  let req;\n  let cancelable = new Promise(download);\n  cancelable.cancel = cancel;\n\n  return cancelable;\n\n  function cancel() {\n    if (req) {\n      req.abort();\n    }\n  }\n\n  function download(resolve, reject) {\n    req = new XMLHttpRequest();\n\n    if (typeof options.progress === 'function') {\n      req.addEventListener('progress', updateProgress, false);\n      // req.upload.addEventListener('progress', updateProgress, false);\n    }\n\n    req.addEventListener('load', transferComplete, false);\n    req.addEventListener('error', transferFailed, false);\n    req.addEventListener('abort', transferCanceled, false);\n\n    req.open(options.method || 'GET', url);\n    if (options.responseType) {\n      req.responseType = options.responseType;\n    }\n    if (options.headers) {\n      Object.keys(options.headers).forEach(key => {\n        req.setRequestHeader(key, options.headers[key]);\n      });\n    }\n\n    if (options.method === 'POST') {\n      req.send(options.body);\n    } else {\n      req.send(null);\n    }\n\n    function updateProgress(e) {\n      if (e.lengthComputable) {\n        options.progress({\n          loaded: e.loaded,\n          total: e.total,\n          percent: e.loaded / e.total,\n          lengthComputable: true\n        });\n      } else {\n        options.progress({\n          loaded: e.loaded,\n          lengthComputable: false\n        });\n      }\n    }\n\n    function transferComplete() {\n      if (req.status !== 200) {\n        reject(`Unexpected status code ${req.status} when calling ${url}`);\n        return;\n      }\n      var response = req.response;\n\n      if (options.responseType === 'json' && typeof response === 'string') {\n        // IE\n        response = JSON.parse(response);\n      }\n\n      resolve(response);\n    }\n\n    function transferFailed() {\n      reject(`Failed to download ${url}`);\n    }\n\n    function transferCanceled() {\n      reject({\n        cancelled: true,\n        message: `Cancelled download of ${url}`\n      });\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/fetch.js","import fetch from './fetch';\nconst fuzzysort = require('fuzzysort')\n\n\nexport default function createDataClient(endpoint) {\n  const fileNames = getFileNames();\n  const downloaded = new Map();\n  const indexed = new Map();\n  const list = [];\n  let prepared = [];\n\n  let sizeCount = 1;\n  let sizes = new Map();\n  fetch(endpoint + 'count.json', {responseType: 'json'})\n    .then(rows => {\n      rows.forEach((row, index) => {\n        row.forEach(subreddit => {\n          sizes.set(subreddit, index + 2);\n        })\n      });\n\n      sizeCount = rows.length + 2;\n    })\n\n  return {\n    getRelated,\n    getSuggestion,\n    getSize\n  }\n\n  function getSize(subName) {\n    let size = sizes.get(subName);\n    return (size || 1)/sizeCount;\n  }\n\n  function getSuggestion(query) {\n    let firstLetter = query[0].toLocaleLowerCase();\n    let results = downloaded.get(firstLetter);\n    if (results) {\n      results = fuzzysort.go(query, prepared, {limit: 10})\n      return Promise.resolve(results.map(x => ({\n        html: fuzzysort.highlight(x, '<b>', '</b>'),\n        text: x.target\n      })));\n    } else {\n      return downloadAndIndexFile(firstLetter).then(() => {\n        return getSuggestion(query);\n      })\n    }\n  }\n\n  function getRelated(query) {\n    let sims = indexed.get(query.toLocaleLowerCase());\n    if (sims) return Promise.resolve(sims);\n\n    return getFileForQuery(query);\n  }\n\n  function downloadAndIndexFile(firstLetter) {\n    let url = endpoint + fileNames.get(firstLetter);\n    console.log('download ', firstLetter);\n    return fetch(url, {responseType: 'json'})\n      .then(response => {\n        downloaded.set(firstLetter, response);\n        response.forEach(row => {\n          let keyName = row[0].toLocaleLowerCase();\n          if (indexed.get(keyName)) return;\n\n          list.push(row[0]);\n          indexed.set(keyName, row);\n        });\n        prepared = list.map(l => fuzzysort.prepare(l));\n      })\n  }\n\n  function getFileForQuery(query) {\n    let firstLetter = query[0].toLocaleLowerCase();\n    let results = downloaded.get(firstLetter);\n    if (results) return Promise.resolve([]);\n\n    return downloadAndIndexFile(firstLetter).then(() => {\n        let sims = indexed.get(query.toLocaleLowerCase())\n        return sims || [];\n      })\n  }\n\n}\n\nfunction getFileNames() {\n  let fileNamesIndex = new Map();\n[\n  '0_z0123456789jqx.json', '10_m.json', '11_l.json', '12_i.json', '13_h.json', '14_g.json', '15_f.json', '16_e.json', '17_d.json', '18_c.json', '19_b.json', '1_yk.json', '20_a.json', '2_w.json', '3_vo.json', '4_u.json', '5_t.json', '6_s.json', '7_r.json', '8_p.json', '9_n.json'\n].forEach(name => {\n    const fileName = name.replace(/^\\d\\d?_/, '').replace(/\\.json$/, '');\n    for (var i = 0; i < fileName.length; ++i) {\n      let letter = fileName[i];\n      fileNamesIndex.set(letter, name);\n    }\n  });\n  return fileNamesIndex;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/createRedditDataClient.js","import createRedditDataClient from \"./createRedditDataClient\";\n\nconst isProd = true;\nconst dataEndpoint = isProd\n  ? \"https://anvaka.github.io/sayit-data/1/\"\n  : \"http://localhost:8081/\";\nconst redditDataClient = createRedditDataClient(dataEndpoint);\n\nexport default redditDataClient;\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/redditDataClient.js","import bus from '../bus';\nimport redditDataClient from './redditDataClient';\n\nexport default function buildGraph(entryWord, MAX_DEPTH, progress) {\n  entryWord = entryWord && entryWord.trim();\n  if (!entryWord) return;\n\n  entryWord = entryWord.toLocaleLowerCase();\n\n  let cancelled = false;\n  let pendingResponse;\n  let graph = require('ngraph.graph')();\n  graph.maxDepth = MAX_DEPTH;\n  let queue = [];\n  let requestDelay = 0;\n  progress.startDownload();\n\n  startQueryConstruction();\n\n  return {\n    dispose,\n    graph\n  }\n\n  function dispose() {\n    cancelled = true;\n    if (pendingResponse) {\n      // pendingResponse.cancel();\n      pendingResponse = null;\n    }\n  }\n\n  function startQueryConstruction() {\n    fetchNext(entryWord);\n  }\n\n  function loadSiblings(results) {\n    const parent = results[0];\n    var parentNode = graph.getNode(parent);\n\n    if (!parentNode) {\n      parentNode = graph.addNode(parent, {\n        depth: 0,\n        size: redditDataClient.getSize(parent)\n      });\n    }\n\n    results.forEach((other, idx) => {\n      if (idx === 0) return;\n\n      const hasOtherNode = graph.hasNode(other);\n      if (hasOtherNode) {\n        const hasOtherLink = graph.getLink(other, parent) || graph.getLink(parent, other);\n        if (!hasOtherLink) {\n          graph.addLink(parent, other);\n        }\n        return;\n      }\n\n      let depth = parentNode.data.depth + 1;\n      graph.addNode(other, {depth, size: redditDataClient.getSize(other)});\n      graph.addLink(parent, other);\n      if (depth < MAX_DEPTH) queue.push(other);\n    });\n\n    setTimeout(loadNext, requestDelay);\n  }\n\n  function loadNext() {\n    if (cancelled) return;\n    if (queue.length === 0) {\n      bus.fire('graph-ready', graph);\n      return;\n    }\n\n    let nextWord = queue.shift();\n    fetchNext(nextWord);\n    progress.updateLayout(queue.length, nextWord);\n  }\n\n  function fetchNext(query) {\n    pendingResponse = redditDataClient.getRelated(query);\n    pendingResponse.then(res => onPendingReady(res, query)).catch((msg) => {\n      const err = 'Failed to download ' + query + '; Message: ' + msg;\n      console.error(err);\n      progress.downloadError(err)\n      loadNext();\n    });\n  }\n\n  function onPendingReady(res, query) {\n    if (!res || !res.length) res = [query];\n    loadSiblings(res);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/buildGraph.js","export default class Progress {\n  constructor() {\n    this.message = '';\n    this.phase = 'none';\n    this.download = {\n      errors: [],\n      remaining: 0,\n      currentWord: '',\n    };\n    this.layout = {\n      iteration: 0\n    };\n    this.working = true\n  }\n\n  startDownload() {\n    this.phase = 'download';\n  }\n\n  startLayout() {\n    this.message = 'Finished download. Constructing layout...';\n    this.phase = 'layout';\n  }\n\n  setLayoutCompletion(layoutCompletion) {\n    if (this.phase === 'layout') {\n      this.message = `Finished download. Constructing layout ${layoutCompletion}%...`;\n    }\n  }\n\n  updateLayout(remaining, nextWord) {\n    this.download.currentWord = nextWord;\n    this.download.remaining = remaining;\n    this.message = `Remaining: ${remaining}. Downloading ${nextWord}`;\n  }\n\n  done() {\n    this.working = false;\n  }\n\n  downloadError(message) {\n    this.download.errors.push(message);\n  }\n\n  reset() {\n    this.phase = 'none',\n    this.download.errors = [];\n    this.download.remaining = 0;\n    this.download.currentWord = '';\n    this.layout.iteration = 0;\n    this.message = '';\n    this.working = true;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Progress.js","import buildGraph from './lib/buildGraph';\nimport Progress from './Progress';\n\nconst queryState = require('query-state');\n\nconst qs = queryState({\n  query: ''\n}, {\n  useSearch: true\n});\n\nlet lastBuilder;\nconst appStateFromQuery = qs.get();\nconst appState = {\n  hasGraph: false,\n  maxDepth: appStateFromQuery.maxDepth || 2,\n  progress: new Progress(),\n  graph: null,\n  query: appStateFromQuery.query,\n}\n\nif (appState.query) {\n  performSearch(appState.query);\n}\n\nexport default appState;\n\nqs.onChange(updateAppState);\n\nfunction updateAppState(newState) {\n  appState.query = newState.query;\n}\n\nexport function performSearch(queryString) {\n  appState.hasGraph = true;\n  appState.progress.reset();\n\n  qs.set('query', queryString);\n  if (lastBuilder) {\n    lastBuilder.dispose();\n  }\n\n  lastBuilder = buildGraph(queryString, appState.maxDepth, appState.progress);\n  appState.graph = Object.freeze(lastBuilder.graph);\n  return lastBuilder.graph;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/appState.js","var svgns = 'http://www.w3.org/2000/svg';\nvar xmlns = 'http://www.w3.org/XML/1998/namespace';\n\n\nexport default function createTextMeasure(svgContainer, options) {\n  options = options || {};\n  if (!('useFastTextMeasure' in options)) {\n    options.useFastTextMeasure = false;\n  }\n\n  var cachedSizes = {};\n  var cachedWords = Object.create(null);\n\n  // TODO: If you need custom language, you might wanna extend this.\n  var abc = 'abcdefghijklmnopqrstuvwxyz';\n  var avgLetterWidthByFontSize = {};\n\n  // Safari doesn't work correctly on font-size smaller than 1 px;\n  var safariGuess = {\n    1: 0.4951923076923077,\n    0.875: 0.43509615384615385,\n    0.833: 0.41346153846153844,\n    0.75: 0.3701923076923077,\n    0.5: 0.24459134615384615,\n  };\n\n  return measure;\n\n  function measure(text, fontSize) {\n    if (fontSize < 1) {\n      // take only first three digits:\n      fontSize = (Math.round(fontSize * 1000)) / 1000;\n    }\n\n    var cacheKey = text + fontSize;\n    var cachedResult = cachedSizes[cacheKey];\n    if (cachedResult) return cachedResult;\n    var result = {};\n\n    cachedSizes[cacheKey] = result;\n\n    var textContainer = window.document.createElementNS(svgns, 'text');\n    // set the font size that is requested.\n    textContainer.setAttributeNS(null, 'font-size', fontSize);\n    // we need this to measure words separators.\n    textContainer.setAttributeNS(xmlns, 'xml:space', 'preserve');\n\n    svgContainer.appendChild(textContainer);\n\n    result.words = text.split(/\\s/).map(toWordWidths);\n    result.spaceWidth = measureSpaceWidth();\n    result.totalWidth = sumUpWordsLengthInPixels(result.words, result.spaceWidth);\n\n    svgContainer.removeChild(textContainer);\n\n    return result;\n\n    function sumUpWordsLengthInPixels(words, spaceWidth) {\n      var width = 0;\n\n      words.forEach(function(word) { width += word.width; });\n      width += (words.length - 1) * spaceWidth;\n\n      return width;\n    }\n\n    function measureSpaceWidth() {\n      var spaceWidthKey = 'space' + fontSize;\n      var spaceWidth = avgLetterWidthByFontSize[spaceWidthKey];\n      if (!spaceWidth) {\n        textContainer.textContent = ' ';\n        spaceWidth = measureTextWidth(textContainer);\n        avgLetterWidthByFontSize[spaceWidthKey] = spaceWidth;\n      }\n\n      return spaceWidth;\n    }\n\n    function toWordWidths(text) {\n      return {\n        text: text,\n        width: measureText(text)\n      };\n    }\n\n    function measureText(text) {\n      return options.useFastTextMeasure ? measureAvgWidth(text) : preciseMeasure(text);\n    }\n\n    function preciseMeasure(text) {\n      var cachedWordsKey = text + fontSize;\n      var size = cachedWords[cachedWordsKey];\n      if (size === undefined) {\n        textContainer.textContent = text;\n        size = measureTextWidth(textContainer);\n        if (size === 0 && text.length > 0) {\n          // safari :(.\n          var avgWidthAtFontSize = safariGuess[fontSize];\n          if (avgWidthAtFontSize === undefined) throw new Error('Font size is not overriden for safari ' + fontSize);\n          size = avgWidthAtFontSize * text.length;\n        }\n        cachedWords[cachedWordsKey] = size;\n      }\n\n      return size;\n    }\n\n    function measureAvgWidth(text) {\n      var avgWidthAtFontSize = avgLetterWidthByFontSize[fontSize];\n      if (!avgWidthAtFontSize) {\n        textContainer.textContent = abc;\n        var abcWidth = measureTextWidth(textContainer);\n        avgWidthAtFontSize = abcWidth/abc.length;\n\n        if (avgWidthAtFontSize === 0) {\n          // safari at small fonts :(. Not super proud of this, but not sure how\n          // to fix this better.\n          avgWidthAtFontSize = safariGuess[fontSize]\n        }\n\n        avgLetterWidthByFontSize[fontSize] = avgWidthAtFontSize;\n      }\n\n      return avgWidthAtFontSize * text.length;\n    }\n  }\n}\n\nfunction measureTextWidth(svgTextElement) {\n  var result = svgTextElement.getBBox();\n  return result.width;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/measureText.js","export class Vector {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n  static sub(a, b) {\n    return new Vector(a.x - b.x, a.y - b.y);\n  }\n  static dist(a, b) {\n    let dx = a.x - b.x;\n    let dy = a.y - b.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n  normalize() {\n    let l = Math.sqrt(this.x * this.x + this.y * this.y);\n    if (l === 0)\n      l = 0.0001;\n    this.x /= l;\n    this.y /= l;\n  }\n  mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n  add(other) {\n    this.x += other.x;\n    this.y += other.y;\n  }\n  sub(other) {\n    this.x -= other.x;\n    this.y -= other.y;\n  }\n  div(scalar) {\n    this.x /= scalar;\n    this.y /= scalar;\n  }\n  mult(scalar) {\n    this.x *= scalar;\n    this.y *= scalar;\n  }\n  limit(maxMag) {\n    let mag = this.mag();\n    if (mag > maxMag) {\n      this.x *= maxMag / mag;\n      this.y *= maxMag / mag;\n    }\n  }\n  distanceTo(other) {\n    let dx = this.x - other.x;\n    let dy = this.y - other.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/Vector.js","import { Vector } from './Vector';\n\n// https://processing.org/examples/flocking.html\n\nvar random = require('ngraph.random')(45);\n\nexport class Flock {\n  constructor(graph) {\n    this.graph = graph;\n    this.boids = new Map();\n    this.neighbors = [];\n  }\n\n  run() {\n    // this.neighbors.forEach(b => b.run(this.neighbors));\n    let boids = this.boids;\n    boids.forEach((boid, nodeId) => {\n      let neighbors = [];\n      this.graph.forEachLinkedNode(nodeId, function(other) {\n        let otherBoid = boids.get(other.id);\n        if (otherBoid) neighbors.push(otherBoid);\n      })\n      boid.run(neighbors);\n    });\n  }\n\n  addBoid(nodeId, b) {\n    this.boids.set(nodeId, b);\n    this.neighbors.push(b);\n  }\n\n  setDesiredBoidPosition(boidId, pos) {\n    const boid = this.boids.get(boidId);\n    if (!boid) return;\n    boid.setDesiredPosition(pos.x, pos.y);\n  }\n}\n\nexport class Boid {\n  constructor(x, y) {\n    this.acceleration = new Vector(0, 0);\n\n    let angle = random.nextDouble() * 2 * Math.PI;\n    this.velocity = new Vector(Math.cos(angle), Math.sin(angle));\n    this.position = new Vector(x, y);\n    this.desiredPosition = new Vector(0, 0);\n    this.r = 400.0;\n    this.maxspeed = 3;\n    this.maxforce = 0.08;\n  }\n\n  run(boids) {\n    this.flock(boids);\n    this.borders();\n    this.update();\n  }\n\n  applyForce(force, nCount) {\n    // We could add mass here if we want A = F / M\n    force.div(nCount)\n    this.acceleration.add(force);\n  }\n\n  setDesiredPosition(x, y) {\n    this.desiredPosition.x = x;\n    this.desiredPosition.y = y;\n  }\n\n  // We accumulate a new acceleration each time based on three rules\n  flock(boids) {\n    let sep = this.separate(boids);   // Separation\n    let ali = this.align(boids);      // Alignment\n    let coh = this.cohesion(boids);   // Cohesion\n    // Arbitrarily weight these forces\n    // sep.mult(1.5);\n    // ali.mult(1.0);\n    // coh.mult(1.0);\n    // Add the force vectors to acceleration\n    const mass = boids.length || 1;\n    this.applyForce(sep, mass);\n    this.applyForce(ali, mass);\n    this.applyForce(coh, mass);\n\n    const pull = Vector.sub(this.desiredPosition, this.position);\n    // pull.div(boids.length);\n    //pull.normalize();\n    pull.limit(0.091);\n    this.applyForce(pull, mass);\n  }\n\n  // Method to update position\n  update() {\n    // Update velocity\n    this.velocity.add(this.acceleration);\n    // Limit speed\n    this.velocity.limit(this.maxspeed);\n    this.position.add(this.velocity);\n    // Reset acceleration to 0 each cycle\n    this.acceleration.mult(0);\n  }\n\n  // A method that calculates and applies a steering force towards a target\n  // STEER = DESIRED MINUS VELOCITY\n  seek(target) {\n    const desired = Vector.sub(target, this.position);  // A vector pointing from the position to the target\n    // Scale to maximum speed\n    desired.normalize();\n    desired.mult(this.maxspeed);\n \n    // Steering = Desired minus Velocity\n    let steer = Vector.sub(desired, this.velocity);\n    steer.limit(this.maxforce * 1);  // Limit to maximum steering force\n    return steer;\n  }\n\n  // Wraparound\n  borders() {\n    return;\n    if (this.position.x < -this.r) this.velocity.x *= -1;\n    if (this.position.y < -this.r) this.velocity.y *= -1;\n    if (this.position.x > this.r) this.velocity.x *= -1;\n    if (this.position.y > this.r) this.velocity.y *= -1;\n  }\n\n  // Separation\n  // Method checks for nearby boids and steers away\n  separate(boids) {\n    const desiredseparation = 40.0;\n    const steer = new Vector(0, 0, 0);\n    let count = 0;\n    // For every boid in the system, check if it's too close\n    boids.forEach((other) => {\n      let d = this.position.distanceTo(other.position);\n      // If the distance is greater than 0 and less than an arbitrary amount (0 when you are yourself)\n      if ((d > 0) && (d < desiredseparation)) {\n        // Calculate vector pointing away from neighbor\n        let diff = Vector.sub(this.position, other.position);\n        diff.normalize();\n        diff.div(d);        // Weight by distance\n        steer.add(diff);\n        count++;            // Keep track of how many\n      }\n    });\n\n    // Average -- divide by how many\n    if (count > 0) {\n      steer.div(count);\n    }\n\n    // As long as the vector is greater than 0\n    if (steer.mag() > 0) {\n      // Implement Reynolds: Steering = Desired - Velocity\n      steer.normalize();\n      steer.mult(this.maxspeed);\n      steer.sub(this.velocity);\n      steer.limit(this.maxforce);\n    }\n\n    return steer;\n  }\n\n  // Alignment\n  // For every nearby boid in the system, calculate the average velocity\n  align(boids) {\n    const neighbordist = 300;\n    const sum = new Vector(0, 0);\n    let count = 0;\n    boids.forEach(other => {\n      let d = Vector.dist(this.position, other.position);\n      if ((d > 0) && (d < neighbordist)) {\n        sum.add(other.velocity);\n        count++;\n      }\n    });\n\n    if (count > 0) {\n      sum.div(count);\n      // Implement Reynolds: Steering = Desired - Velocity\n      sum.normalize();\n      sum.mult(this.maxspeed);\n      let steer = Vector.sub(sum, this.velocity);\n      steer.limit(this.maxforce);\n      return steer;\n    } \n    else {\n      return new Vector(0, 0);\n    }\n  }\n\n  // Cohesion\n  // For the average position (i.e. center) of all nearby boids, calculate steering vector towards that position\n  cohesion(boids) {\n    const neighbordist = 300;\n    let sum = new Vector(0, 0);   // Start with empty vector to accumulate all positions\n    let count = 0;\n    boids.forEach(other => {\n      let d = Vector.dist(this.position, other.position);\n      if ((d > 0) && (d < neighbordist)) {\n        sum.add(other.position); // Add position\n        count++;\n      }\n    })\n\n    if (count > 0) {\n      sum.div(count);\n      return this.seek(sum);  // Steer towards the position\n    } \n    else {\n      return new Vector(0, 0);\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/flock.js","import {Flock, Boid} from './flock';\nlet createRandom = require('ngraph.random');\n\nexport default function createFakeLayout(graph) {\n  let nodes = new Map();\n  let random = createRandom(42);\n  const flock = new Flock(graph);\n  \n  return {\n    addNode,\n    getNodePosition,\n    setDesiredNodePosition,\n    step\n  };\n\n  function addNode(nodeId) {\n    const pos = {\n      x: (random.nextDouble() - 0.5) * 1000,\n      y: (random.nextDouble() - 0.5) * 1000\n    }\n    const boid = new Boid(pos.x, pos.y);\n    flock.addBoid(nodeId, boid);\n    nodes.set(nodeId, boid);\n    return boid;\n  }\n\n  function getNodePosition(nodeId) {\n    let pos = nodes.get(nodeId)\n    if (!pos) {\n      pos = addNode(nodeId);\n    } \n    return pos.position;\n  }\n\n  function step() {\n    flock.run();\n  }\n\n  function setDesiredNodePosition(nodeId, pos) {\n    flock.setDesiredBoidPosition(nodeId, pos);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/boidLayout.js","import  Delaunator from 'delaunator';\nimport createGraph from 'ngraph.graph';\n\nexport default function getDelaunayGraph(vertices) {\n  const delaunay = Delaunator.from(vertices);\n  const triangles = delaunay.triangles;\n  const triangulationGraph = createGraph()\n  vertices.forEach(v => {\n    triangulationGraph.addNode(v.id, v);\n  });\n\n  for (let i = triangles.length; i;) {\n    --i\n    const first = vertices[triangles[i]]\n    --i\n    const second = vertices[triangles[i]]\n    --i\n    const third = vertices[triangles[i]]\n\n    addTriangulationLink(first.id, second.id, triangulationGraph)\n    addTriangulationLink(second.id, third.id, triangulationGraph)\n    addTriangulationLink(third.id, first.id, triangulationGraph)\n  }\n\n  return triangulationGraph;\n}\n\nfunction addTriangulationLink (fromId, toId, tGraph) {\n  tGraph.addLink(fromId, toId)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/getDelaunayGraph.js","const createGraph = require('ngraph.graph')\n\nexport default function makeSpanningTree(mstEdges) {\n  const graph = createGraph();\n\n  mstEdges.forEach(e => {\n    graph.addLink(e.from.id, e.to.id)\n  })\n\n  // Doesn't really matter what is the root\n  const rootId = mstEdges[0].from.id\n\n  return {\n    getGraph() {\n      return graph\n    },\n    getRootId() {\n      return rootId\n    },\n    get(id) {\n      return graph.gentNode(id)\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/makeSpanningTree.js","import findMinimumSpanningTree from 'ngraph.kruskal';\nimport getDelaunayGraph from './getDelaunayGraph';\nimport makeSpanningTree from './makeSpanningTree';\nvar randomAPI = require('ngraph.random');\n\nclass EdgeModel {\n  constructor (from, to) {\n    this.from = from\n    this.to = to\n  }\n}\n\n/**\n * For a given set of rectangles, removes overlaps\n *\n * @param {Map} rectangles - rectId -> Rectangle mapping\n */\nexport default function removeOverlaps(rectangles, options) {\n  // Convert rectangle centers into vertices, that we can feed into Delaunay\n  // triangulation\n  const vertices = []\n  options = options || {}\n\n  const canMove = options.canMove || yes\n  const pullX = options.pullX || false\n  const pullY = options.pullY || false\n\n  if (rectangles.size < 2) {\n    return;\n  }\n  if (rectangles.size === 2) {\n    // we cannot triangulate this, so let's just cal it directly\n    let arrayOfRects = Array.from(rectangles).map(x => x[1]);\n\n    removeOverlapsForRectangles(arrayOfRects[0], arrayOfRects[1]);\n    return;\n  }\n\n  rectangles.forEach(r => {\n    const pair = [r.cx, r.cy]\n    pair.id = r.id\n    vertices.push(pair)\n  })\n\n  let totalMovement = 0;\n  const triangulationGraph = getDelaunayGraph(vertices)\n  triangulationGraph.forEachLink(addTriangulationLinkWeight);\n\n  const mst = findMinimumSpanningTree(triangulationGraph, e => e.data)\n  const mstEdges = mst.map(edge => new EdgeModel(\n    getRect(edge.fromId),\n    getRect(edge.toId)\n  ));\n\n  var randomIterator = randomAPI.randomIterator(mstEdges);\n  randomIterator.shuffle();\n\n  let spanningTree\n  if (mstEdges.length > 0) {\n    spanningTree = makeSpanningTree(mstEdges)\n\n    grow(spanningTree)\n  }\n\n  return totalMovement;\n\n  function getRect (id) {\n    return rectangles.get(id)\n  }\n\n  function grow(spanningTree) {\n    const spanningGraph = spanningTree.getGraph()\n\n    const processed = new Set()\n    growAt(spanningTree.getRootId())\n\n    function growAt(nodeId) {\n      if (processed.has(nodeId)) return\n\n      processed.add(nodeId)\n\n      const rootPos = getRect(nodeId)\n\n      spanningGraph.forEachLinkedNode(nodeId, otherNode => {\n        if (processed.has(otherNode.id)) return\n\n        const childPos = getRect(otherNode.id)\n        removeOverlapsForRectangles(rootPos, childPos);\n        growAt(otherNode.id)\n      })\n    }\n  }\n\n  function removeOverlapsForRectangles(rootPos, childPos) {\n    if (overlaps(rootPos, childPos)) {\n      let t = getOverlapFactor(rootPos, childPos)\n      let dx = (childPos.cx - rootPos.cx)\n      let dy = (childPos.cy - rootPos.cy)\n\n      if (!Number.isFinite(t)) {\n        t = 1\n        dx = 1e-3\n        dy = -1e-3\n      }\n\n      if (canMove(childPos.id)) {\n        childPos.cx = rootPos.cx + t * dx\n        childPos.cy = rootPos.cy + t * dy\n      } else {\n        rootPos.cx = childPos.cx - t * dx\n        rootPos.cy = childPos.cy - t * dy\n      }\n      totalMovement += Math.sqrt(t * t * (dx * dx + dy * dy));\n    }\n  }\n\n  /**\n  * Given two rectangles returns a value by which they overlap\n  */\n  function getOverlapFactor (a, b) {\n    const dx = Math.abs(a.cx - b.cx)\n    const dy = Math.abs(a.cy - b.cy)\n\n    const wx = (a.width + b.width) / 2\n    const wy = (a.height + b.height) / 2\n\n    const t = Math.min(wx / dx, wy / dy)\n    return t\n  }\n\n  function addTriangulationLinkWeight(link) {\n    const from = getRect(link.fromId)\n    const to = getRect(link.toId)\n    const weight = getTriangulationWeight(from, to)\n    link.data = weight;\n  }\n\n  function getTriangulationWeight(a, b) {\n    if (overlaps(a, b)) {\n      const centerDistance = getPointDistance(a, b)\n      const t = getOverlapFactor(a, b)\n      return -(t - 1) * centerDistance\n    }\n\n    return getRectangularDistance(a, b)\n  }\n\n  function overlaps(a, b) {\n    if (pullX) {\n      return true;\n    }\n    // If one rectangle is on left side of other\n    // NOTE: This gives funny results when we always return true\n    if (a.left > b.right || b.left > a.right) return pullX\n\n    // If one rectangle is above other\n    if (a.top > b.bottom || b.top > a.bottom) return pullY\n\n    return true\n  }\n\n  function getRectangularDistance(a, b) {\n    if (overlaps(a, b)) return 0\n    let dx = 0\n    let dy = 0\n\n    if (a.right < b.left) {\n      dx = b.right - a.left\n    } else if (b.right < a.left) {\n      dx = a.left - b.right\n    }\n\n    if (a.top < b.bottom) {\n      dy = b.bottom - a.top\n    } else if (b.top < a.bottom) {\n      dy = a.bottom - b.top\n    }\n\n    return Math.sqrt(dx * dx + dy * dy)\n  }\n\n  function getPointDistance(a, b) {\n    const dx = a.cx - b.cx\n    const dy = a.cy - b.cy\n\n    return Math.sqrt(dx * dx + dy * dy)\n  }\n}\n\nfunction yes() {\n  return true\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/removeOverlaps.js","export default class Rect {\n  constructor (params) {\n    Object.assign(this, params)\n    if (!isNumber(this.left)) throw new Error('Left is wrong')\n    if (!isNumber(this.top)) throw new Error('top is wrong')\n    if (!isNumber(this.width)) throw new Error('width is wrong')\n    if (!isNumber(this.height)) throw new Error('height is wrong')\n  }\n\n  inflate(factor) {\n    this.left += factor * this.width/2;\n    this.top += factor * this.height/2;\n    this.width *= factor;\n    this.height *= factor;\n  }\n\n  get right () {\n    return this.left + this.width\n  }\n\n  get bottom () {\n    return this.top + this.height\n  }\n\n  get cx () {\n    return this.left + this.width / 2\n  }\n\n  get cy () {\n    return this.top + this.height / 2\n  }\n\n  set cx (x) {\n    this.left = x - this.width / 2\n  }\n\n  set cy (y) {\n    this.top = y - this.height / 2\n  }\n}\n\nfunction isNumber (x) {\n  if (!Number.isFinite(x)) return false\n  return true\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/layout/Rect.js","import createFakeLayout from './layout/boidLayout';\nimport createInterpolateLayout from './createInterpolateLayout';\nimport removeOverlaps from './layout/removeOverlaps';\nimport Rect from './layout/Rect';\n\nlet eventify = require('ngraph.events');\n\nlet createLayout = require('ngraph.forcelayout')\nconst USE_FAKE = 1;\nconst USE_INTERPOLATE = 2;\nconst REMOVE_OVERLAPS = 3;\nconst USE_REAL = 4;\n\n/**\n * Orchestrates layout of algorithm between phases.\n */\nexport default function createAggregateLayout(graph, progress) {\n  const MAX_DEPTH = graph.maxDepth;\n  let physicsLayout = createPhysicsLayout(graph);\n  let fakeLayout = createFakeLayout(graph);\n  let interpolateLayout = createInterpolateLayout(fakeLayout, physicsLayout);\n\n  let isGraphReady = false;\n  let layoutIterations = 0;\n  let layoutTime = 0;\n  let maxLayoutIterations = 2000;\n  let maxLayoutTime = 2000;\n  let phase = USE_FAKE;\n  let rectangles = new Map();\n\n  var api = eventify({\n    step,\n    pinNode,\n    getNodePosition,\n    addNode,\n    setGraphReady,\n    getGraphReady\n  })\n\n  return api;\n\n  function setGraphReady() {\n    layoutIterations = 0;\n    layoutTime = 0;\n    isGraphReady = true;\n  }\n\n  function getGraphReady() {\n    return isGraphReady;\n  }\n\n  function addNode(nodeId, rect) {\n    fakeLayout.addNode(nodeId, rect);\n    rectangles.set(nodeId, rect);\n  }\n\n  function getNodePosition(nodeId) {\n    if (phase === USE_FAKE || phase === REMOVE_OVERLAPS) return fakeLayout.getNodePosition(nodeId);\n    if (phase === USE_REAL) return physicsLayout.getNodePosition(nodeId);\n    if (phase === USE_INTERPOLATE) return interpolateLayout.getNodePosition(nodeId);\n  }\n\n  function step() {\n    if (!isGraphReady || layoutIterations < maxLayoutIterations) {\n      phase = USE_FAKE;\n      let start = window.performance.now();\n      fakeLayout.step();\n\n      do {\n        physicsLayout.step();\n        layoutIterations += 1;\n      } while (window.performance.now() - start < 10)\n      layoutTime += window.performance.now() - start;\n      \n\n      if (layoutTime > maxLayoutTime) layoutIterations = maxLayoutIterations;\n      const finished = Math.min(1, Math.max(layoutTime/maxLayoutTime, layoutIterations/maxLayoutIterations));\n      syncLayouts();\n\n      progress.setLayoutCompletion(Math.round(finished * 100));\n\n      if (layoutIterations >= maxLayoutIterations) phase = REMOVE_OVERLAPS;\n\n      return true;\n    } else if (phase === REMOVE_OVERLAPS) {\n      runOverlapsRemoval();\n      phase = USE_INTERPOLATE;\n\n      return true;\n    } else if (phase === USE_INTERPOLATE) {\n      interpolateLayout.step();\n      if (interpolateLayout.done()) {\n        phase = USE_REAL;\n        api.fire('ready', api);\n      }\n      return true;\n    } \n\n    return false;\n  }\n\n  function syncLayouts() {\n    graph.forEachNode(function (node) {\n      var pos = physicsLayout.getNodePosition(node.id);\n      fakeLayout.setDesiredNodePosition(node.id, pos);\n    })\n  }\n\n  function runOverlapsRemoval() {\n    // TODO: Async?\n    let rectangles = getRectangles();\n    let move = 0, delta = 0; \n    do {\n      let newMove = removeOverlaps(rectangles);\n      delta = Math.abs(newMove - move);\n      move = newMove;\n    } while (delta > 1);\n    rectangles.forEach((rect, nodeId) => {\n      physicsLayout.setNodePosition(nodeId, rect.left - rect.dx, rect.top - rect.dy);\n    });\n  }\n\n  function getRectangles() {\n    let rects = new Map();\n    rectangles.forEach((rect, id) => {\n      let pos = physicsLayout.getNodePosition(id);\n      let {width, height} = rect;\n      const inflatedRect = new Rect({\n        id, \n        left: pos.x + rect.x,\n        top: pos.y + rect.y,\n        dx: rect.x,\n        dy: rect.y,\n        width,\n        height,\n      });\n      rects.set(id, inflatedRect);\n    });\n\n    return rects;\n  }\n\n  function pinNode(node) {\n    physicsLayout.pinNode(node, true);\n  }\n\n  function createPhysicsLayout() {\n    return createLayout(graph, {\n      springLength: 20,\n      springCoeff: 0.002,\n      gravity: -1.2,\n      theta: 0.8,\n      dragCoeff: 0.02,\n      timeStep: 14,\n      nodeMass(nodeId) {\n        let links = graph.getLinks(nodeId);\n        let mul = links ? links.length : 1;\n        let node = graph.getNode(nodeId);\n        mul *=  node.data.size * 3;\n        let mass = nodeId.length * mul;\n        return mass || 1;\n      }\n    });\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/aggregateLayout.js","export default function createInterpolateLayout(from, to, duration = 100) {\n  let t = 0;\n  let elapsed = 0;\n\n  return {\n    step,\n    getNodePosition,\n    done,\n  };\n\n  function step() {\n    elapsed += 1;\n  }\n\n  function done() {\n    return elapsed > duration;\n  }\n\n  function getNodePosition(nodeId) {\n    t = ease(elapsed/duration);\n    let fromPos = from.getNodePosition(nodeId);\n    let toPos = to.getNodePosition(nodeId);\n\n    return {\n      x: fromPos.x * (1 - t) + toPos.x * t,\n      y: fromPos.y * (1 - t) + toPos.y * t\n    }\n  }\n\n  function ease(t) {\n    return t*(2-t);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/createInterpolateLayout.js","let svg = require('simplesvg');\nlet random = require('ngraph.random')(42);\n\nexport default function createLinkAnimator(graph, layout, edgeContainer) {\n  const links = new Map();\n  let beingAnimated = new Map();\n  const scheduled = [];\n  let maxAnimations = 20;\n  let maxDepth = graph.maxDepth;\n  graph.forEachLink(scheduleLink);\n  scheduled.sort((a, b) => {\n    return getLinkScore(a) - getLinkScore(b)\n  })\n  let processor = requestAnimationFrame(processNext);\n\n  return {\n    getLinkInfo,\n    dispose\n  }\n\n  function dispose() {\n    if (processor) {\n      cancelAnimationFrame(processor);\n      processor = null;\n    }\n  }\n\n  function processNext() {\n    while (beingAnimated.size < maxAnimations && scheduled.length > 0) {\n      let link = scheduled.pop()\n      let speed = Math.round(Math.abs(random.gaussian() * 30)) + 1\n      beingAnimated.set(link.id, animateLink(link, speed));\n    }\n\n    beingAnimated.forEach(function(el, key) {\n      el.step();\n      if (el.isDone) beingAnimated.delete(key);\n    });\n    if (scheduled.length > 0 || beingAnimated.size > 0) {\n      processor = requestAnimationFrame(processNext);\n    }\n  }\n\n  function getLinkInfo(linkId) {\n    return links.get(linkId);\n  }\n\n  function getLinkScore(link) {\n    let fromNode = graph.getNode(link.fromId).data;\n    let toNode = graph.getNode(link.toId).data;\n    const depth = (fromNode.depth + toNode.depth)/2;\n    return (maxDepth - depth)/maxDepth;\n  }\n\n  function scheduleLink(link) {\n    scheduled.push(link);\n  }\n\n  function animateLink(link, maxT) {\n    var frame = 0;\n    let from = layout.getNodePosition(link.fromId);\n    let to = layout.getNodePosition(link.toId);\n\n    const dRatio = getLinkScore(link)\n    const strokeWidth = 8 * dRatio + 2;\n    const color = Math.round((200 - 75) * (1 - dRatio) + 75);\n\n    let api = {\n      step,\n      isDone: false\n    }\n    return api;\n\n    function step() {\n      let t = ease(frame/maxT);\n      let x = from.x * (1 - t) + to.x * t;\n      let y = from.y * (1 - t) + to.y * t;\n      let linkInfo = links.get(link.id);\n      let pathData = `M${from.x},${from.y} L${x},${y}`;\n      if (!linkInfo) {\n        const ui = svg('path', {\n          id: link.id,\n          'stroke-width': strokeWidth,\n          fill: 'black',\n          stroke: `rgb(${color}, ${color}, ${color})`,\n          d: pathData \n        });\n        edgeContainer.appendChild(ui);\n\n        links.set(link.id, {ui, link});\n      } else {\n        linkInfo.ui.attr('d', pathData);\n      }\n      frame += 1;\n      if (frame > maxT) {\n        api.isDone = true;\n      }\n    }\n  }\n}\n\nfunction ease(t) {\n  return t*(2-t);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/renderer/linkAnimator.js","import createPanZoom from \"panzoom\";\nimport createTextMeasure from \"./measureText\";\nimport createAggregateLayout from \"./aggregateLayout\";\nimport bus from \"../bus\";\nimport createLinkAnimator from \"./renderer/linkAnimator\";\n\nlet svg = require(\"simplesvg\");\n\nexport default function createRenderer(progress) {\n  const scene = document.querySelector(\"#scene\");\n  const nodeContainer = scene.querySelector(\"#nodes\");\n  const edgeContainer = scene.querySelector(\"#edges\");\n  let lastPanTime = 0;\n  let lastTouchEndTime = 0;\n  let clickTimeout;\n\n  const panzoom = createPanZoom(scene);\n  const defaultRectangle = { left: -500, right: 500, top: -500, bottom: 500 };\n  panzoom.showRectangle(defaultRectangle);\n\n  // maps node id to node ui\n  let nodes = new Map();\n\n  let layout,\n    graph,\n    currentLayoutFrame = 0,\n    linkAnimator;\n  let textMeasure = createTextMeasure(scene);\n  bus.on(\"graph-ready\", onGraphReady);\n\n  return {\n    render,\n    dispose\n  };\n\n  function dispose() {\n    clearLastScene();\n    bus.off(\"graph-ready\", onGraphReady);\n  }\n\n  function onMouseClick(e) {\n    const clickTarget = e.target;\n    if (!nodeContainer.contains(clickTarget)) return;\n\n    let nodeId = getNodeIdFromUI(clickTarget);\n    bus.fire(\"show-subreddit\", nodeId);\n\n    removeClass(\"hovered\");\n    removeClass(\"emphasized\");\n\n    const mainNode = nodes.get(nodeId);\n    mainNode.classList.add(\"hovered\");\n    mainNode.classList.add(\"emphasized\");\n    graph.forEachLinkedNode(nodeId, function(otherNode, link) {\n      const ui = nodes.get(otherNode.id);\n      ui.classList.add(\"hovered\");\n      moveToFront(ui);\n\n      const linkInfo = linkAnimator.getLinkInfo(link.id);\n      if (linkInfo) {\n        const linkUI = linkInfo.ui;\n        linkUI.classList.add(\"hovered\");\n        moveToFront(linkUI);\n      }\n    });\n    moveToFront(mainNode);\n  }\n\n  function onDoubleClickMouse(e) {\n    const clickTarget = e.target;\n    if (!nodeContainer.contains(clickTarget)) return;\n\n    e.stopPropagation(); // so that we don't zoom\n    onDoubleClick(e);\n  }\n\n  function onDoubleClick(e) {\n    const clickTarget = e.target;\n    if (!nodeContainer.contains(clickTarget)) return;\n\n    let nodeId = getNodeIdFromUI(clickTarget);\n    if (nodeId) {\n      bus.fire(\"new-search\", nodeId);\n      panzoom.showRectangle(defaultRectangle);\n    }\n  }\n\n  function moveToFront(el) {\n    const { parentNode } = el;\n    parentNode.removeChild(el);\n    parentNode.appendChild(el);\n  }\n\n  function getNodeIdFromUI(el) {\n    while (el) {\n      if (el.classList.contains(\"node\")) return el.id;\n      el = el.parentNode;\n    }\n  }\n\n  function removeClass(className) {\n    const elements = scene.querySelectorAll(`.${className}`);\n    if (elements) {\n      for (let i = 0; i < elements.length; ++i) {\n        elements[i].classList.remove(className);\n      }\n    }\n  }\n\n  function render(newGraph) {\n    clearLastScene();\n    graph = newGraph;\n\n    layout = createAggregateLayout(graph, progress);\n\n    layout.on(\"ready\", drawLinks);\n\n    nodes = new Map();\n\n    graph.forEachNode(addNode);\n    graph.on(\"changed\", onGraphStructureChanged);\n\n    cancelAnimationFrame(currentLayoutFrame);\n    currentLayoutFrame = requestAnimationFrame(frame);\n  }\n\n  function onGraphReady(readyGraph) {\n    if (readyGraph === graph) {\n      layout.setGraphReady();\n      progress.startLayout();\n    }\n  }\n\n  function frame() {\n    if (layout.step()) {\n      currentLayoutFrame = requestAnimationFrame(frame);\n    }\n    updatePositions();\n  }\n\n  function onGraphStructureChanged(changes) {\n    changes.forEach(change => {\n      if (change.changeType === \"add\" && change.node) {\n        addNode(change.node);\n      }\n    });\n  }\n\n  function drawLinks() {\n    progress.done();\n    linkAnimator = createLinkAnimator(graph, layout, edgeContainer);\n    document.addEventListener(\"click\", onMouseClick);\n    document.addEventListener(\"dblclick\", onDoubleClickMouse, true);\n    document.addEventListener(\"touchend\", onTouchEnd);\n\n    panzoom.on(\"pan\", onPan);\n  }\n\n  function clearLastScene() {\n    clear(nodeContainer);\n    clear(edgeContainer);\n\n    document.removeEventListener(\"click\", onMouseClick);\n    document.removeEventListener(\"dblclick\", onDoubleClickMouse, true);\n    document.removeEventListener(\"touchend\", onTouchEnd);\n\n    panzoom.off(\"pan\", onPan);\n    if (layout) layout.off(\"ready\", drawLinks);\n    if (graph) graph.off(\"changed\", onGraphStructureChanged);\n    if (linkAnimator) linkAnimator.dispose();\n  }\n\n  function onTouchEnd(e) {\n    let now = new Date();\n    let dTouchEnd = now - lastTouchEndTime;\n    let dPan = now - lastPanTime;\n    lastTouchEndTime = now;\n    clearTimeout(clickTimeout);\n\n    if (dPan < 500) {\n      return;\n    }\n    if (dTouchEnd < 300) {\n      onDoubleClick(e);\n      return;\n    }\n    // console.log(\"tap\", e.target);\n    clickTimeout = setTimeout(() => onMouseClick(e), 320);\n  }\n\n  function onPan() {\n    lastPanTime = new Date();\n  }\n\n  function clear(el) {\n    while (el.lastChild) {\n      el.removeChild(el.lastChild);\n    }\n  }\n\n  function addNode(node) {\n    const dRatio = node.data.size * 1.2; // (graph.maxDepth - node.data.depth)/graph.maxDepth;\n    let pos = getNodePosition(node.id);\n    if (node.data.depth === 0) {\n      layout.pinNode(node);\n    }\n\n    const uiAttributes = getNodeUIAttributes(node.id, dRatio);\n    layout.addNode(node.id, uiAttributes);\n\n    const rectAttributes = {\n      x: uiAttributes.x,\n      y: uiAttributes.y,\n      width: uiAttributes.width,\n      height: uiAttributes.height,\n      rx: uiAttributes.rx,\n      ry: uiAttributes.ry,\n      fill: \"white\",\n      \"stroke-width\": uiAttributes.strokeWidth,\n      stroke: \"#aaa\" // '#58585A'\n    };\n    const textAttributes = {\n      \"font-size\": uiAttributes.fontSize,\n      x: uiAttributes.px,\n      y: uiAttributes.py\n    };\n\n    const rect = svg(\"rect\", rectAttributes);\n    const text = svg(\"text\", textAttributes);\n    text.text(node.id);\n\n    const ui = svg(\"g\", {\n      class: \"node\",\n      id: node.id,\n      transform: `translate(${pos.x}, ${pos.y})`\n    });\n    ui.appendChild(rect);\n    ui.appendChild(text);\n\n    nodeContainer.appendChild(ui);\n    nodes.set(node.id, ui);\n  }\n\n  function getNodeUIAttributes(nodeId, dRatio) {\n    const fontSize = 24 * dRatio + 12;\n    const size = textMeasure(nodeId, fontSize);\n    const width = size.totalWidth + size.spaceWidth * 6;\n    const height = fontSize * 1.6;\n\n    return {\n      fontSize,\n      width,\n      height,\n      x: -width / 2,\n      y: -height / 2,\n      rx: 15 * dRatio + 2,\n      ry: 15 * dRatio + 2,\n      px: -width / 2 + size.spaceWidth * 3,\n      py: -height / 2 + fontSize * 1.1,\n      strokeWidth: 4 * dRatio + 1\n    };\n  }\n\n  function updatePositions() {\n    nodes.forEach((ui, nodeId) => {\n      let pos = getNodePosition(nodeId);\n      ui.attr(\"transform\", `translate(${pos.x}, ${pos.y})`);\n    });\n  }\n\n  function getNodePosition(nodeId) {\n    return layout.getNodePosition(nodeId);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/createRenderer.js","<template>\n  <div class=\"about\">\n    <div class=\"background absolute\" @click.prevent=\"close\"></div>\n    <div class=\"content\">\n      <h3>\n        Related subreddits\n        <a class=\"close bold highlight\" href=\"#\" @click.prevent=\"close\">close</a>\n      </h3>\n      <p>This website shows you a graph of related subreddits for any given one</p>\n      <img src=\"https://i.imgur.com/1dJiwRC.png\" alt=\"Related Subreddits\" style=\"width: 100%;\">\n\n      <p>\n        The relationship is determined by a metric \"users who posted to this subreddit also post to...\".\n        Under the hood I'm using Jaccard Similarity to determine degree of similarity.\n      </p>\n      <ul>\n        <li>\n          Find the source code\n          <a href=\"http://github.com/anvaka/sayit\" class=\"highlight\">on GitHub.</a>\n        </li>\n        <li>\n          Stay tuned for updates on\n          <a href=\"https://twitter.com/anvaka\" class=\"highlight\">Twitter.</a>\n        </li>\n        <li>\n          <a href=\"https://www.patreon.com/anvaka\" class=\"highlight\">Support me on Patreon</a> .\n        </li>\n      </ul>\n      <p>I hope you like it! Please let me know.</p>\n      <p>With passion,\n        <br>Anvaka\n      </p>\n      <a href=\"#\" @click.prevent=\"close\" class=\"large-close bold highlight\">close</a>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  mounted() {\n    this.closeHandler = e => {\n      if (e.keyCode === 27) {\n        e.preventDefault();\n        this.close();\n      }\n    };\n    document.addEventListener(\"keyup\", this.closeHandler);\n  },\n  beforeDestroy() {\n    document.removeEventListener(\"keyup\", this.closeHandler);\n  },\n  methods: {\n    close() {\n      this.$emit(\"close\");\n    }\n  }\n};\n</script>\n\n<style lang='stylus'>\n.about {\n  position: fixed;\n  overflow: hidden;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n\n  .close {\n    position: absolute;\n    right: 15px;\n    font-size: 12px;\n  }\n\n  .large-close {\n    width: 100%;\n    height: 32px;\n    display: block;\n    text-align: center;\n  }\n\n  .content {\n    overflow-y: auto;\n    max-height: 100%;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), 0 -1px 0px rgba(0, 0, 0, 0.02);\n    position: absolute;\n    background-color: white;\n    width: 400px;\n    padding: 14px;\n    border: 1px solid #58585A;\n\n    h3 {\n      margin: 0;\n      font-weight: normal;\n    }\n  }\n}\n\n.background {\n  position: absolute;\n  background-color: #58585A;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n\n@media (max-width: 800px) {\n  .about {\n    justify-content: initial;\n  }\n\n  .about .content {\n    width: 100%;\n    border: none;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/About.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"about\"},[_c('div',{staticClass:\"background absolute\",on:{\"click\":function($event){$event.preventDefault();return _vm.close($event)}}}),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('h3',[_vm._v(\"\\n      Related subreddits\\n      \"),_c('a',{staticClass:\"close bold highlight\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.close($event)}}},[_vm._v(\"close\")])]),_vm._v(\" \"),_c('p',[_vm._v(\"This website shows you a graph of related subreddits for any given one\")]),_vm._v(\" \"),_c('img',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":\"https://i.imgur.com/1dJiwRC.png\",\"alt\":\"Related Subreddits\"}}),_vm._v(\" \"),_c('p',[_vm._v(\"\\n      The relationship is determined by a metric \\\"users who posted to this subreddit also post to...\\\".\\n      Under the hood I'm using Jaccard Similarity to determine degree of similarity.\\n    \")]),_vm._v(\" \"),_vm._m(0),_vm._v(\" \"),_c('p',[_vm._v(\"I hope you like it! Please let me know.\")]),_vm._v(\" \"),_vm._m(1),_vm._v(\" \"),_c('a',{staticClass:\"large-close bold highlight\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.close($event)}}},[_vm._v(\"close\")])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',[_c('li',[_vm._v(\"\\n        Find the source code\\n        \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"http://github.com/anvaka/sayit\"}},[_vm._v(\"on GitHub.\")])]),_vm._v(\" \"),_c('li',[_vm._v(\"\\n        Stay tuned for updates on\\n        \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"https://twitter.com/anvaka\"}},[_vm._v(\"Twitter.\")])]),_vm._v(\" \"),_c('li',[_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"https://www.patreon.com/anvaka\"}},[_vm._v(\"Support me on Patreon\")]),_vm._v(\" .\\n      \")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"With passion,\\n      \"),_c('br'),_vm._v(\"Anvaka\\n    \")])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2dfb328f\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/About.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2dfb328f\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./About.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./About.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./About.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2dfb328f\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./About.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/About.vue\n// module id = null\n// module chunks = ","<template>\n  <div class=\"ak-typeahead\">\n    <input\n      v-model=\"currentQuery\"\n      ref=\"input\"\n      autofocus\n      :readonly=\"readonly\"\n      autocomplete=\"off\"\n      autocorrect=\"off\"\n      autocapitalize=\"off\"\n      spellcheck=\"false\"\n      :placeholder=\"placeholder\"\n      @input=\"getSuggestionsInternal\"\n      @keydown=\"cycleTheList\"\n    >\n    <a\n      type=\"submit\"\n      class=\"search-submit\"\n      href=\"#\"\n      @click.prevent=\"pickCurrentText\"\n      v-if=\"currentQuery\"\n    >Go</a>\n    <ul v-if=\"showSuggestions\" class=\"suggestions\">\n      <li v-for=\"(suggestion, index) in suggestions\" :key=\"index\">\n        <a\n          @click.prevent=\"pickSuggestion(suggestion)\"\n          class=\"suggestion\"\n          :class=\"{selected: suggestion.selected}\"\n          href=\"#\"\n          v-html=\"suggestion.html\"\n        ></a>\n      </li>\n    </ul>\n\n    <ul v-if=\"showLoading\" class=\"suggestions\">\n      <li class=\"searching\">\n        <span v-if=\"!loadingError\">Searching...</span>\n        <div v-if=\"loadingError\" class=\"loading-error\">\n          <div>Failed to get reddit completions:</div>\n          <pre>{{loadingError}}</pre>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<style lang='stylus'>\n@import '../vars.styl';\n\n.ak-typeahead {\n  height: 100%;\n  flex: 1;\n  align-items: stretch;\n\n  input::-ms-clear {\n    display: none;\n  }\n}\n\n.search-submit {\n  color: #B2B2B2;\n  position: absolute;\n  right: 0;\n  top: 0;\n  height: 100%;\n  align-items: center;\n  text-decoration: none;\n  display: flex;\n  flex-shrink: 0;\n  width: 48px;\n  justify-content: center;\n  outline: none;\n\n  &:hover, &:focus {\n    color: background-color;\n    background: highlight-color;\n  }\n}\n\n.suggestion {\n  display: block;\n  width: 100%;\n  height: 28px;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n  text-decoration: none;\n  font-weight: bold;\n  color: primary-text;\n\n  b {\n    font-weight: normal;\n  }\n}\n\n.suggestion:hover, .suggestion.selected {\n  background-color: #eee;\n}\n\n.suggestions {\n  position: absolute;\n  top: 48px;\n  width: 100%;\n  padding: 0;\n  background: white;\n  list-style-type: none;\n  margin: 0;\n  border-top: 1px solid $border-color;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\n  .searching {\n    margin: 8px;\n  }\n\n  .loading-error {\n    pre {\n      color: orangered;\n      overflow-x: auto;\n      padding-bottom: 14px;\n    }\n  }\n}\n\ninput {\n  height: 100%;\n  width: 100%;\n  padding-left: 10px;\n  font-size: 18px;\n  border: 0;\n}\n\ninput:focus {\n  outline: none;\n}\n\ninput::placeholder {\n  color: $hint-text;\n}\n</style>\n\n<script>\nexport default {\n  props: {\n    readonly: {\n      default: false\n    },\n    placeholder: {\n      default: \"Type here\"\n    },\n    getSuggestions: {\n      default: function(query) {\n        return query.split();\n      }\n    },\n    query: {\n      default: \"\"\n    },\n    delay: {\n      default: 80\n    }\n  },\n  data() {\n    return {\n      currentSelected: -1,\n      showSuggestions: false,\n      showLoading: false,\n      loadingError: null,\n      suggestions: [],\n      currentQuery: this.query\n    };\n  },\n  watch: {\n    query(newQuery) {\n      this.currentQuery = newQuery;\n    }\n  },\n  methods: {\n    refresh() {\n      if (this.showSuggestions) this.getSuggestionsInternal();\n    },\n\n    hideSuggestions() {\n      this.showSuggestions = false;\n      this.showLoading = false;\n      this.pendingKeyToShow = true;\n    },\n\n    showIfNeeded(visible) {\n      // we need to wait until next keypress before we can show suggestion.\n      // This avoids race conditions between search results and form submission\n      if (!this.pendingKeyToShow) this.showSuggestions = visible;\n    },\n\n    focus() {\n      this.$refs.input.focus();\n    },\n\n    pickCurrentText() {\n      this.pickSuggestion({ text: this.currentQuery });\n    },\n\n    pickSuggestion(suggestion) {\n      this.currentQuery = suggestion.text;\n      this.hideSuggestions();\n      this.$emit(\"selected\", this.currentQuery);\n    },\n\n    getSuggestionsInternal() {\n      var self = this;\n      if (self.previous) {\n        window.clearTimeout(self.previous);\n      }\n      if (!self.currentQuery) {\n        this.showSuggestions = false;\n        return;\n      }\n\n      self.previous = window.setTimeout(function() {\n        self.previous = null;\n\n        var query = self.currentQuery;\n        var p = self.getSuggestions(query);\n\n        if (Array.isArray(p)) {\n          self.suggestions = p.map(x => ({\n            selected: false,\n            text: x.text,\n            html: x.html\n          }));\n          self.currentSelected = -1;\n          self.showIfNeeded(p && p.length > 0);\n        } else if (p) {\n          self.loadingError = null;\n          self.showLoading = true;\n          p.then(\n            function(suggestions) {\n              self.showLoading = false;\n              suggestions = suggestions || [];\n              self.suggestions = suggestions.map(x => ({\n                selected: false,\n                text: x.text,\n                html: x.html\n              }));\n              self.currentSelected = -1;\n              self.showIfNeeded(suggestions && suggestions.length > 0);\n            },\n            function(err) {\n              self.loadingError = err;\n            }\n          );\n        } else {\n          throw new Error(\"Could not parse suggestions response\");\n        }\n      }, self.delay);\n    },\n\n    cycleTheList(e) {\n      var items = this.suggestions;\n      var currentSelected = this.currentSelected;\n      // Any key is alright for the suggestions\n      this.pendingKeyToShow = false;\n\n      let dx;\n      if (e.which === 38) {\n        // UP\n        dx = -1;\n      } else if (e.which === 40) {\n        // down\n        dx = 1;\n      } else if (e.which === 13) {\n        // Enter === accept\n        if (items[currentSelected]) {\n          this.pickSuggestion(items[currentSelected]);\n        } else {\n          this.pickSuggestion({ text: this.currentQuery });\n        }\n        e.preventDefault();\n        return;\n      } else if (e.which === 27) {\n        // Esc === close\n        this.hideSuggestions();\n      }\n\n      if (!dx || items.length === 0) return;\n\n      e.preventDefault();\n\n      if (currentSelected >= 0) {\n        this.suggestions[currentSelected].selected = false;\n      }\n      currentSelected += dx;\n      if (currentSelected < 0) currentSelected = items.length - 1;\n      if (currentSelected >= items.length) currentSelected = 0;\n\n      this.suggestions[currentSelected].selected = true;\n      this.currentSelected = currentSelected;\n    }\n  }\n};\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Typeahead.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"ak-typeahead\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.currentQuery),expression:\"currentQuery\"}],ref:\"input\",attrs:{\"autofocus\":\"\",\"readonly\":_vm.readonly,\"autocomplete\":\"off\",\"autocorrect\":\"off\",\"autocapitalize\":\"off\",\"spellcheck\":\"false\",\"placeholder\":_vm.placeholder},domProps:{\"value\":(_vm.currentQuery)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.currentQuery=$event.target.value},_vm.getSuggestionsInternal],\"keydown\":_vm.cycleTheList}}),_vm._v(\" \"),(_vm.currentQuery)?_c('a',{staticClass:\"search-submit\",attrs:{\"type\":\"submit\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.pickCurrentText($event)}}},[_vm._v(\"Go\")]):_vm._e(),_vm._v(\" \"),(_vm.showSuggestions)?_c('ul',{staticClass:\"suggestions\"},_vm._l((_vm.suggestions),function(suggestion,index){return _c('li',{key:index},[_c('a',{staticClass:\"suggestion\",class:{selected: suggestion.selected},attrs:{\"href\":\"#\"},domProps:{\"innerHTML\":_vm._s(suggestion.html)},on:{\"click\":function($event){$event.preventDefault();_vm.pickSuggestion(suggestion)}}})])})):_vm._e(),_vm._v(\" \"),(_vm.showLoading)?_c('ul',{staticClass:\"suggestions\"},[_c('li',{staticClass:\"searching\"},[(!_vm.loadingError)?_c('span',[_vm._v(\"Searching...\")]):_vm._e(),_vm._v(\" \"),(_vm.loadingError)?_c('div',{staticClass:\"loading-error\"},[_c('div',[_vm._v(\"Failed to get reddit completions:\")]),_vm._v(\" \"),_c('pre',[_vm._v(_vm._s(_vm.loadingError))])]):_vm._e()])]):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2dc990e2\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Typeahead.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2dc990e2\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Typeahead.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Typeahead.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Typeahead.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2dc990e2\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Typeahead.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Typeahead.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <form v-on:submit.prevent=\"onSubmit\" class=\"search-box\">\n      <!-- <input class='search-input' type=\"text\" v-model='appState.query' placeholder='Enter query' autofocus> -->\n      <typeahead\n        placeholder=\"Enter subreddit name\"\n        ref:typeahead\n        @selected=\"doSearch\"\n        :query=\"appState.query\"\n        :get-suggestions=\"getSuggestions\"\n      ></typeahead>\n    </form>\n    <div class=\"help\" v-if=\"!isLoading\">\n      The graph of related subreddits\n      <a\n        href=\"#\"\n        @click.prevent=\"aboutVisible = true\"\n        class=\"highlight\"\n      >Learn more.</a>\n    </div>\n    <div class=\"help\" v-if=\"isLoading\">{{appState.progress.message}}</div>\n    <div class=\"about-line\">\n      <a class=\"about-link\" href=\"#\" @click.prevent=\"aboutVisible = true\">about</a>\n      <a class=\"bold\" href=\"https://github.com/anvaka/sayit\">source code</a>\n    </div>\n\n    <about v-if=\"aboutVisible\" @close=\"aboutVisible = false\"></about>\n\n    <div class=\"welcome\" v-if=\"!appState.hasGraph\">\n      <h3>Welcome!</h3>\n      <p>\n        This website renders graph of related subreddits.\n        <a\n          class=\"highlight\"\n          href=\"#\"\n          @click.prevent=\"aboutVisible = true\"\n        >Click here</a> to learn more, or\n        <a class=\"highlight\" href=\"?query=math\">try demo</a>.\n      </p>\n    </div>\n\n    <div class=\"tooltip\" ref=\"tooltip\">{{tooltip.text}}</div>\n    <subreddit v-if=\"subreddit\" :name=\"subreddit\" class=\"preview\"></subreddit>\n    <div class=\"close-container\" v-if=\"subreddit\">\n      <a href=\"#\" @click.prevent=\"subreddit = null\">close</a>\n    </div>\n  </div>\n</template>\n\n<script>\nimport \"vuereddit/dist/vuereddit.css\";\n\nimport appState, { performSearch } from \"./appState.js\";\nimport Subreddit from \"vuereddit\";\nimport createRenderer from \"./lib/createRenderer\";\nimport About from \"./components/About\";\nimport Typeahead from \"./components/Typeahead\";\nimport bus from \"./bus\";\nimport redditDataClient from \"./lib/redditDataClient\";\n\nexport default {\n  name: \"App\",\n  data() {\n    return {\n      aboutVisible: false,\n      subreddit: null,\n      appState,\n      tooltip: {\n        text: \"\",\n        x: \"\",\n        y: \"\"\n      }\n    };\n  },\n  components: {\n    About,\n    Typeahead,\n    Subreddit\n  },\n  computed: {\n    isLoading() {\n      return appState.progress.working;\n    }\n  },\n  methods: {\n    doSearch(q) {\n      appState.query = q;\n      this.onSubmit();\n    },\n    getSuggestions(input) {\n      return redditDataClient.getSuggestion(input);\n    },\n    onSubmit() {\n      if (!appState.query) return;\n\n      performSearch(appState.query);\n      this.renderer.render(appState.graph);\n      const el = document.querySelector(\":focus\");\n      if (el) el.blur();\n    },\n    showSubreddit(name) {\n      this.subreddit = name;\n    }\n  },\n  mounted() {\n    this.renderer = createRenderer(appState.progress);\n    bus.on(\"show-subreddit\", this.showSubreddit);\n    bus.on(\"new-search\", this.doSearch);\n\n    if (appState.graph) {\n      this.renderer.render(appState.graph);\n    }\n  },\n\n  beforeDestroy() {\n    bus.off(\"show-subreddit\", this.showSubreddit);\n    bus.off(\"new-search\", this.doSearch);\n  }\n};\n</script>\n\n<style lang='stylus'>\n@import ('./vars.styl');\n\n#app {\n  position: relative;\n  margin: 8px 14px;\n  width: 392px;\n  background: background-color;\n}\n\n.close-container {\n  position: fixed;\n  z-index: 2;\n  top: 0;\n  right: 0;\n  height: 40px;\n\n  a {\n    padding: 0 12px;\n    font-size: 12px;\n    color: #fff;\n    background-color: #333;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n  }\n}\n\n.highlight {\n  color: highlight-color;\n}\n\nrect, path, text {\n  transition: stroke 200ms, fill 200ms;\n}\n\n.hovered rect, path.hovered {\n  stroke: highlight-color;\n}\n\n.hovered rect {\n  stroke: highlight-color;\n}\n\n.help {\n  font-size: 12px;\n  margin-top: 8px;\n\n  a {\n    background: background-color;\n  }\n}\n\n.special {\n  color: highlight-color;\n  font-family: monospace;\n}\n\na {\n  text-decoration: none;\n}\n\n.about-line {\n  position: fixed;\n  right: 0;\n  top: 8px;\n  padding: 0px 0;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n\n  a {\n    text-align: right;\n    background: background-color;\n    font-size: 12px;\n    padding: 0 8px;\n    line-height: 24px;\n    height: 24px;\n    color: secondary-color;\n    border-bottom: 1px solid transparent;\n\n    &:hover, &:focus {\n      color: highlight-color;\n      border-bottom: 1px dashed;\n    }\n  }\n}\n\n.tooltip {\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), 0 -1px 0px rgba(0, 0, 0, 0.02);\n  position: fixed;\n  background: background-color;\n  padding: 8px;\n  border: 1px solid border-color;\n  pointer-events: none;\n  opacity: 0;\n  transition-duration: 300ms;\n  transition-property: opacity;\n}\n\n.tooltip.visible {\n  opacity: 1;\n}\n\n.search-box {\n  position: relative;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), 0 -1px 0px rgba(0, 0, 0, 0.02);\n  height: 48px;\n  display: flex;\n  font-size: 16px;\n  padding: 0;\n  cursor: text;\n\n  span {\n    display: flex;\n    align-items: center;\n    flex-shrink: 0;\n  }\n}\n\n.subreddit.preview {\n  position: fixed;\n  right: 0;\n  top: 0;\n  width: 400px;\n  overflow: hidden;\n\n  a {\n    target: '_blank';\n  }\n\n  .controls {\n    position: absolute;\n    top: 42px;\n    right: 0;\n    left: 1px;\n    height: 32px;\n  }\n}\n\n.title-area {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 42px;\n}\n\n@media (max-width: 800px) {\n  #app {\n    width: 100%;\n    margin: 0;\n  }\n\n  .welcome {\n    padding: 16px;\n  }\n\n  .help {\n    padding: 0 8px;\n  }\n\n  .about-line {\n    bottom: 0;\n    top: initial;\n    right: 0;\n  }\n\n  .subreddit.preview {\n    width: 100%;\n  }\n}\n\ng.node {\n  cursor: pointer;\n}\n\n.details-container {\n  position: absolute;\n  top: 82px;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n}\n\n.read-more {\n  linear-gradient(180deg, rgba(255, 255, 255, 0), #fff);\n}\n\n@media (max-height: 550px) {\n  .search-box {\n    height: 32px;\n\n    input.search-input {\n      font-size: 16px;\n    }\n  }\n\n  .help {\n    margin-top: 4px;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('form',{staticClass:\"search-box\",on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_c('typeahead',{attrs:{\"placeholder\":\"Enter subreddit name\",\"ref:typeahead\":\"\",\"query\":_vm.appState.query,\"get-suggestions\":_vm.getSuggestions},on:{\"selected\":_vm.doSearch}})],1),_vm._v(\" \"),(!_vm.isLoading)?_c('div',{staticClass:\"help\"},[_vm._v(\"\\n    The graph of related subreddits\\n    \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.aboutVisible = true}}},[_vm._v(\"Learn more.\")])]):_vm._e(),_vm._v(\" \"),(_vm.isLoading)?_c('div',{staticClass:\"help\"},[_vm._v(_vm._s(_vm.appState.progress.message))]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"about-line\"},[_c('a',{staticClass:\"about-link\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.aboutVisible = true}}},[_vm._v(\"about\")]),_vm._v(\" \"),_c('a',{staticClass:\"bold\",attrs:{\"href\":\"https://github.com/anvaka/sayit\"}},[_vm._v(\"source code\")])]),_vm._v(\" \"),(_vm.aboutVisible)?_c('about',{on:{\"close\":function($event){_vm.aboutVisible = false}}}):_vm._e(),_vm._v(\" \"),(!_vm.appState.hasGraph)?_c('div',{staticClass:\"welcome\"},[_c('h3',[_vm._v(\"Welcome!\")]),_vm._v(\" \"),_c('p',[_vm._v(\"\\n      This website renders graph of related subreddits.\\n      \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.aboutVisible = true}}},[_vm._v(\"Click here\")]),_vm._v(\" to learn more, or\\n      \"),_c('a',{staticClass:\"highlight\",attrs:{\"href\":\"?query=math\"}},[_vm._v(\"try demo\")]),_vm._v(\".\\n    \")])]):_vm._e(),_vm._v(\" \"),_c('div',{ref:\"tooltip\",staticClass:\"tooltip\"},[_vm._v(_vm._s(_vm.tooltip.text))]),_vm._v(\" \"),(_vm.subreddit)?_c('subreddit',{staticClass:\"preview\",attrs:{\"name\":_vm.subreddit}}):_vm._e(),_vm._v(\" \"),(_vm.subreddit)?_c('div',{staticClass:\"close-container\"},[_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.subreddit = null}}},[_vm._v(\"close\")])]):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-04de8ffb\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-04de8ffb\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-04de8ffb\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from \"vue\";\nimport App from \"./App\";\n\nVue.config.productionTip = false;\n\n/* eslint-disable no-new */\nnew Vue({\n  el: \"#app\",\n  components: { App },\n  template: \"<App/>\"\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}